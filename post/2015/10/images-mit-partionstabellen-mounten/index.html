<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de-DE" lang="de-DE">

<head>
  <title>
    Images mit Partionstabellen mounten // Michael im Netz
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.15-DEV" />

  <meta property="og:title" content="Images mit Partionstabellen mounten" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://0rph3us.github.io/post/2015/10/images-mit-partionstabellen-mounten/" />


  
  
  

    
    
    <link rel="stylesheet" href="https://0rph3us.github.io/css/6c4ae43c-ac4d-4a71-ab4f-4cd485c2ac5f.css">

  
  


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

    
  
  <link rel="stylesheet" href="https://0rph3us.github.io/css/solarized_light-8.7.min.css">
  
  <script async src="https://0rph3us.github.io/js/highlight-8.7.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	

    <h1 class="brand-title"><a href="https://0rph3us.github.io">Michael Rennecke</a></h1>
    <h2 class="brand-tagline">Meine Gedanken zu Sicherheit, Linux und Random Stuff</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://0rph3us.github.io">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/about/">Über mich</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/links/">Links</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/spickzettel/">Spickzettel</a></li>
        
      </ul>
    </nav>

    
    <div class="zozial-buttons">
      
        
        <a href="https://github.com/0rph3us" target="_blank"><i class='fa fa-github'></i></a>
        
      
        
        <a href="https://twitter.com/0rph3us" target="_blank"><i class='fa fa-twitterhack'></i></a>
        
      
        
        <a href="https://0rph3us.github.io/rss.xml" target="_blank"><i class='fa fa-rss'></i></a>
        
      
      
    </div>
    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a id="top"></a>
		

		
			
		    <div id="toc" class="pure-u-1 pure-u-md-1-4">
				<small class="toc-label">Inhalt</small>
		   	 	<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#backup-erstellen:f07b0a87c6d8ece6184d80edbd0252a3">Backup erstellen</a></li>
<li><a href="#backup-ansehen:f07b0a87c6d8ece6184d80edbd0252a3">Backup ansehen</a></li>
</ul></li>
</ul>
</nav>
		    </div>
		    
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/post/2015/10/images-mit-partionstabellen-mounten/">Images mit Partionstabellen mounten</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>1</sup></span><span class="post-date-separator">/</span><span class="post-date-month"> Oktober</span> <span class="post-date-year">2015</span>
            	</span>
            	
            
            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-linux" href="https://0rph3us.github.io/categories/linux">Linux</a>
				
					<a class="post-category post-category-tools" href="https://0rph3us.github.io/categories/tools">Tools</a>
				
				</div>
			

			

			

            

<p>Ein Vorteil vom Raspberry Pi ist, dass das Betriebssystem auf einer SD-Karte
ist. Dadurch kann man relativ einfach ein Backup vom gesamten System machen.
Ich gehe davon aus, dass man noch einen weiteren Rechner mit Linux zur
Verfügung hat.</p>

<p>Ein Backup bietet sich auf jeden Fall an, wenn man ein größeres Update plant
oder ein etwas Experimentiert und viel Software nachinstallieren muss. Im
zweiten Fall kann man schnell sein System verfriemeln und man weiß nicht nicht
mehr was man alles verändert hat.</p>

<h2 id="backup-erstellen:f07b0a87c6d8ece6184d80edbd0252a3">Backup erstellen</h2>

<p>Am einfachsten kann man ein Backup der kompletten SD-Karte mit <code>dd</code> machen. Dabei
muss man die Karte in einen zweiten Rechner stecken und heraus finden, wie die SD-Karte heißt.</p>

<pre><code class="language-sh">$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda           8:0    0 232,9G  0 disk
├─sda1        8:1    0  46,6G  0 part /
└─sda3        8:3    0 186,3G  0 part /home
mmcblk0     179:0    0  14,7G  0 disk
├─mmcblk0p1 179:1    0   256M  0 part
└─mmcblk0p2 179:2    0  14,5G  0 part
</code></pre>

<p>Man sieht, dass das Device für die SD-Karte <code>mmcblk0</code> ist.
Das andere Device ist meine Festplatte.</p>

<p>Mit <code>dd</code> machen wir das eigenliche Backup. Dabei wird der
gesamte Inhalt von <code>/dev/mmcblk0</code> in die Datei <code>$HOME/backups/pi-backup-$(date +%F).img</code>
geschrieben. <code>$(date +%F)</code> fügt das aktuelle Datum in
den Dateinamen ein.</p>

<pre><code class="language-sh">sudo dd if=/dev/mmcblk0 of=$HOME/backups/pi-backup-$(date +%F).img bs=4096
</code></pre>

<p>Nun hat man ein Backup fertig.</p>

<h2 id="backup-ansehen:f07b0a87c6d8ece6184d80edbd0252a3">Backup ansehen</h2>

<p>Beim Raspberry Pi ist eine Partionstabelle auf der
SD-Karte. Die Daten befinden sich in der 2. Partion.
Diese muss man mounten.</p>

<pre><code class="language-sh">$ sudo kpartx $HOME/backups/pi-backup-2015-09-30.img
[sudo] password for rennecke:
loop0p1 : 0 114688 /dev/loop0 8192
loop0p2 : 0 62211072 /dev/loop0 122880
loop deleted : /dev/loop0
</code></pre>

<p>Nun weiß man, dass die zweite Partion bei Block 62211072
beginnt. Das mounten geht jetzt wie folgt:</p>

<pre><code>sudo mount -o loop,rw,offset=62914560 $HOME/backups/pi-backup-2015-09-30.img /mnt
</code></pre>

<p>Ich muss meistens das Abbild beim ersten mal ReadWrite <code>rw</code> mounten, da das Dateisystem überprüft werden muss.
Sonst kann man auch ReadOnly <code>ro</code> mounten. Das hat den Vorteil, dass man nichts aus versehen im Backup verändern kann.</p>

<p>Nachdem man die Partion gemountet hat, kann man mit <code>rsync</code> oder einfach kopieren einzelne Dateien bzw. ganze Verzeichnisse wieder herstellen. <code>rsync</code> kann man auch in verbindung mit ssh verwenden.</p>

	
			

			
				<div class="tags-list">
					<span class="dark-red">Tags</span><span class="decorative-marker">//</span>
					
	                <a class="post-tag post-tag-dd" href="https://0rph3us.github.io/tags/dd">dd</a>,
	                
	                <a class="post-tag post-tag-backup" href="https://0rph3us.github.io/tags/backup">Backup</a>,
	                
	                <a class="post-tag post-tag-raspberry-pi" href="https://0rph3us.github.io/tags/raspberry-pi">Raspberry Pi</a>,
	                
	                <a class="post-tag post-tag-sd-karte" href="https://0rph3us.github.io/tags/sd-karte">SD-Karte</a>,
	                
				</div>
			

			
				<div class="paging">
					<span class="paging-label">Mehr zum lesen</span>
					

					
					<div class="paging-older">
						<span class="dark-red">Älter</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/post/2015/10/raspbian-jessie/">Raspbian Jessie</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>

	<p>Diese Seite ist unter der <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> lizenziert.</p>
</div>
    </div>
  </div>
	

	

  

</body>
</html>
