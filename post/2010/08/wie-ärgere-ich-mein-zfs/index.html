<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de-DE" lang="de-DE">

<head>
  <title>
    Wie ärgere ich mein zfs // Michael im Netz
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.15-DEV" />

  <meta property="og:title" content="Wie ärgere ich mein zfs" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://0rph3us.github.io/post/2010/08/wie-%C3%A4rgere-ich-mein-zfs/" />


  
  
  

    
    
    <link rel="stylesheet" href="https://0rph3us.github.io/css/6c4ae43c-ac4d-4a71-ab4f-4cd485c2ac5f.css">

  
  


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Michael im Netz" />

    
  
  <link rel="stylesheet" href="https://0rph3us.github.io/css/solarized_light-8.4.min.css">
  
  <script src="https://0rph3us.github.io/js/highlight-8.4.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

    <h1 class="brand-title">Michael Rennecke</h1>
    <h2 class="brand-tagline">Meine Gedanken zu Sicherheit, Linux und Random Stuff</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://0rph3us.github.io">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/about/">Über mich</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/links/">Links</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/spickzettel/">Spickzettel</a></li>
        
      </ul>
    </nav>

    
    <div class="zozial-buttons">
      
        
        <a href="https://github.com/0rph3us" target="_blank"><i class='fa fa-github'></i></a>
        
      
        
        <a href="/rss/index.xml" target="_blank"><i class='fa fa-rss'></i></a>
        
      
      
    </div>
    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a id="top"></a>
		

		
			
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/post/2010/08/wie-%C3%A4rgere-ich-mein-zfs/">Wie ärgere ich mein zfs</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>10</sup></span><span class="post-date-separator">/</span><span class="post-date-month"> August</span> <span class="post-date-year">2010</span>
            	</span>
            	
            
            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-solaris" href="https://0rph3us.github.io/categories/solaris">Solaris</a>
				
				</div>
			

			

			

            <p>
<a href="http://hub.opensolaris.org/bin/view/Community+Group+zfs/WebHome">zfs</a> hat den Ruf, dass es unzerstörbar ist. Ab und zu hört man, dass User xy sein zfs kaputt bekommen hat und meint, dass <a href="http://hub.opensolaris.org/bin/view/Community+Group+zfs/WebHome">zfs</a> nicht mehr kann als sein altes Dateisystem. Wenn man sich mal ansieht, was der User xy gemacht hat, dann bemerkt der aufmerksame <a href="http://www.systemhelden.com/">Systemheld</a>, dass man mit derartigen Attacken auch Enterprise Storage-Systeme im Wert von mehreren Millionen kaputt bekommt.</p>
<h4>Was kann zfs nicht</h4>
<ul>
<li>im laufenden Betrieb mehr Plattenausfälle verkraften als die zur Verfügung stehende Redundanz</li>
<li>im laufenden Betrieb mehr Platten tauschen, als man Redundanz hat</li>
<li>mit kaputten Platten laufen</li>
</ul>
<p>Auch wenn es zu den einen oder andern Punkt abweichende Behauptungen gibt, so muss ich hier ausdrücklich sagen, dass ein solches Verhalten im Allgemeinen Fall <strong>unmöglich</strong> ist. Es <strong>kann</strong> hingegen sein, dass man aus einem zerstörten zpool noch Daten retten kann. Das funktioniert aber nur mit <strong>Glück</strong>.</p>
<h4>Was kann zfs</h4>
<p>Das folgende habe ich auf einer <a href="http://docs.sun.com/app/docs/coll/e450?l=en">Sun Enterprise E450</a> und einem <a href="http://docs.sun.com/app/docs/coll/d1000-arrray">StorEdge D1000</a> ausprobiert. Im StorEdge hatte ich einen bunten Mix aus 36 GB und 18 GB Platten. Das folgende <strong>sollte</strong> man nicht an einem Produktivsystem ausprobieren! Bei den Testläufen habe ich <tt>/dev/random</tt> bzw. <tt>/dev/zero</tt> in eine Datei, auf den betreffenden zpool geschrieben.</p>
<ul>
<li>Sämtliche Schweinereien mit den Platten gehen, solange man die Redundanz einhält.</li>
<li>Die Platten vom Strom trennen oder ein Systemabsturz provozieren. Das zfs überlebt das alles und bleibt konsistent</li>
<li>Wenn das System herunter gefahren ist, alle Platten des <strong>nicht exportierten</strong> zpool mischen. Das ärgert das zfs schon sehr,<br />
       ich musste meinen zpool exportieren und wieder importieren, damit alles wieder korrekt funktioniert hat</li>
<li>Aus einen buten Plattenmix ein raidz bzw. ein raidz2 bauen. Das macht aber aus Performancesicht <strong>keinen</strong> Sinn.</li>
<li>Im laufenden Betrieb eine Platte wechseln (wenn man Redundanz hat)</li>
</ul>
<p>
Das war eigenlich alles, was ich mit zfs probiert habe. Ich hatte nicht mehr dumme Ideen. zfs verhält sich auf Dateien anderst als auf echten Devices. Was daran liegt, dass Dateien evtl. noch im Cache sind. Jeder, der die Möglichkeit hat, sollte einige Szenarien vorher einmal ausprobieren.</p>

	
			

			
				<div class="tags-list">
					<span class="dark-red">Tags</span><span class="decorative-marker">//</span>
					
	                <a class="post-tag post-tag-hack" href="https://0rph3us.github.io/tags/hack">hack</a>,
	                
	                <a class="post-tag post-tag-storedge-d1000" href="https://0rph3us.github.io/tags/storedge-d1000">StorEdge D1000</a>,
	                
	                <a class="post-tag post-tag-sun-enterprise" href="https://0rph3us.github.io/tags/sun-enterprise">Sun Enterprise</a>,
	                
	                <a class="post-tag post-tag-zfs" href="https://0rph3us.github.io/tags/zfs">zfs</a>,
	                
				</div>
			

			
				<div class="paging">
					<span class="paging-label">Mehr zum lesen</span>
					
					<div class="paging-newer">
						<span class="dark-red">Neuer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/post/2010/08/die-weierstra%C3%9F-funktion/">Die Weierstraß-Funktion</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Älter</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/post/2010/07/amarok-kde-und-co/">amarok, KDE und Co</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>

	<p>Diese Seite ist unter der <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> lizenziert.</p>
</div>
    </div>
  </div>
	

	

  

</body>
</html>
